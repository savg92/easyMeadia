{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component, EventEmitter, Output, inject } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { Router } from '@angular/router';\nexport let SignInFormComponent = class SignInFormComponent {\n  constructor(loginService) {\n    this.loginService = loginService;\n    // router\n    this.router = inject(Router);\n    // show/hide password\n    this.showPassword = false;\n    this.input = 'password';\n    // form validation\n    this.loginForm = new FormGroup({\n      email: new FormControl('', [Validators.required, Validators.pattern('^[a-z0-9._%+-]+@[a-z0-9.-]+.[a-z]{2,4}$')]),\n      password: new FormControl('', Validators.required)\n    });\n    // send data to parent component?\n    this.emailSubmitted = new EventEmitter();\n    this.passwordSubmitted = new EventEmitter();\n    this.errorEmail = '';\n    this.errorEmailOrPassword = '';\n  }\n  toggleShow() {\n    this.showPassword = !this.showPassword;\n    this.input = this.showPassword ? 'text' : 'password';\n  }\n  onSubmit(event) {\n    event.preventDefault();\n    if (this.loginForm.valid) {\n      const email = this.loginForm.value.email;\n      this.emailSubmitted.emit(email);\n      const password = this.loginForm.value.password;\n      this.passwordSubmitted.emit(password);\n      // console.log(this.loginForm.value);\n      try {\n        this.loginService.login(this.loginForm.value).subscribe(res => {\n          document.cookie = `token=${res.token}; path=/; SameSite=Strict; Secure; HttpOnly; max-age=1800`;\n          localStorage.setItem('token', res.token);\n          console.log(res);\n          this.loginForm.reset();\n          this.errorEmail = '';\n          this.errorEmailOrPassword = '';\n          this.router.navigateByUrl('/add-note');\n        }, error => {\n          // console.log(error);\n          // ? fix prevent default\n          this.errorEmailOrPassword = 'Invalid email or password';\n        });\n      } catch (error) {\n        console.log(error);\n        // this.errorEmailOrPassword = 'Invalid email or password';\n        this.errorEmailOrPassword = 'An error occured, please try again later';\n      }\n    } else {\n      const emailControl = this.loginForm.get('email');\n      if (emailControl && !emailControl.valid) {\n        this.errorEmail = 'Please provide a valid email';\n      }\n    }\n  }\n};\n__decorate([Output()], SignInFormComponent.prototype, \"emailSubmitted\", void 0);\n__decorate([Output()], SignInFormComponent.prototype, \"passwordSubmitted\", void 0);\nSignInFormComponent = __decorate([Component({\n  selector: 'app-sign-in-form',\n  templateUrl: './sign-in-form.component.html',\n  styleUrls: ['./sign-in-form.component.scss']\n})], SignInFormComponent);","map":{"version":3,"names":["Component","EventEmitter","Output","inject","FormControl","FormGroup","Validators","Router","SignInFormComponent","constructor","loginService","router","showPassword","input","loginForm","email","required","pattern","password","emailSubmitted","passwordSubmitted","errorEmail","errorEmailOrPassword","toggleShow","onSubmit","event","preventDefault","valid","value","emit","login","subscribe","res","document","cookie","token","localStorage","setItem","console","log","reset","navigateByUrl","error","emailControl","get","__decorate","selector","templateUrl","styleUrls"],"sources":["/Users/santiago.valenzuela/Desktop/Easy Media/frontend/src/app/components/sign-in-form/sign-in-form.component.ts"],"sourcesContent":["import { Component, EventEmitter, Output, inject } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { Router } from '@angular/router';\nimport { LoginService } from 'src/app/services/login/login.service';\n\n@Component({\n\tselector: 'app-sign-in-form',\n\ttemplateUrl: './sign-in-form.component.html',\n\tstyleUrls: ['./sign-in-form.component.scss'],\n})\nexport class SignInFormComponent {\n\tconstructor(private loginService: LoginService) {}\n\n\t// router\n\trouter = inject(Router);\n\n\t// show/hide password\n\tshowPassword = false;\n\tinput = 'password';\n\ttoggleShow() {\n\t\tthis.showPassword = !this.showPassword;\n\t\tthis.input = this.showPassword ? 'text' : 'password';\n\t}\n\n\t// form validation\n\tloginForm = new FormGroup({\n\t\temail: new FormControl('', [\n\t\t\tValidators.required,\n\t\t\tValidators.pattern('^[a-z0-9._%+-]+@[a-z0-9.-]+.[a-z]{2,4}$'),\n\t\t]),\n\t\tpassword: new FormControl('', Validators.required),\n\t});\n\n\t// send data to parent component?\n\t@Output() emailSubmitted = new EventEmitter();\n\t@Output() passwordSubmitted = new EventEmitter();\n\n\terrorEmail = '';\n\terrorEmailOrPassword = '';\n\n\tonSubmit(event: Event) {\n\t\tevent.preventDefault();\n\t\t\n\t\tif (this.loginForm.valid) {\n\t\t\tconst email = this.loginForm.value.email;\n\t\t\tthis.emailSubmitted.emit(email);\n\n\t\t\tconst password = this.loginForm.value.password;\n\t\t\tthis.passwordSubmitted.emit(password);\n\n\t\t\t// console.log(this.loginForm.value);\n\n\t\t\ttry {\n\t\t\t\tthis.loginService.login(this.loginForm.value).subscribe(\n\t\t\t\t\t(res: any) => {\n\t\t\t\t\tdocument.cookie = `token=${res.token}; path=/; SameSite=Strict; Secure; HttpOnly; max-age=1800`;\n\t\t\t\t\tlocalStorage.setItem('token', res.token);\n\t\t\t\t\tconsole.log(res);\n\n\t\t\t\t\tthis.loginForm.reset();\n\t\t\t\t\tthis.errorEmail = '';\n\t\t\t\t\tthis.errorEmailOrPassword = '';\n\t\t\t\t\tthis.router.navigateByUrl('/add-note');\n\t\t\t\t},\n\t\t\t\t\t(error: any) => {\n\t\t\t\t\t\t// console.log(error);\n\n\n\n\t\t\t\t\t\t// ? fix prevent default\n\t\t\t\t\t\tthis.errorEmailOrPassword = 'Invalid email or password';\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t} catch (error: any) {\n\t\t\t\tconsole.log(error);\n\t\t\t\t// this.errorEmailOrPassword = 'Invalid email or password';\n\t\t\t\tthis.errorEmailOrPassword = 'An error occured, please try again later';\n\t\t\t}\n\t\t} else {\n\t\t\tconst emailControl = this.loginForm.get('email');\n\t\t\tif (emailControl && !emailControl.valid) {\n\t\t\t\tthis.errorEmail = 'Please provide a valid email';\n\t\t\t}\n\t\t}\n\t}\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}